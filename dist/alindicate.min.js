angular.module('alIndicate', ['underscore']);

var underscore = angular.module('underscore', []);
underscore.factory('_', ['$window', function($window) {
  return $window._; // assumes underscore has already been loaded on the page
}]);

angular.module('alIndicate').directive('alIndicatorOne', function() {
  return {
    restrict: 'E',
    replace: true,
    template: '<div class="indicator-one"><div class="indicator-one-progress-container"></div></div>',
    scope: {
      progress: "=",
      onComplete: "&"
    },
    controller: function($scope) {

    },
    link: function(scope, el, attrs) {
      scope.$watch('progress', function(newVal) {
          var progressContainer = el[0].querySelector('.indicator-one-progress-container');
          progressContainer.style.width = 100*newVal + "%";

          if(newVal >= 1.0) {
              scope.onComplete();
          }

      });
  }
}
})

angular.module('alIndicate').directive('alIndicatorTwo', ['_', function() {
    return {
        restrict: "E",
        template: '<div class="indicator-two"><div class="node node-{{i}}" ng-repeat="i in nodesRange"></div></div>',
        scope: {},
        controller:function($scope, _) {
            $scope.nodesRange = _.range(0,20);
            console.log($scope.nodesRange);
        },
        link: function(scope, el, attr) {

        }
    }
}]);
